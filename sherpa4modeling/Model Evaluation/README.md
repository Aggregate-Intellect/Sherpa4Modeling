# Domain_Model_Elevation
This is the thesis work for domain model evelvation

To build a runnable conda env:
```
conda create --name myenv python=3.8
pip install worde4mde
pip install pandas
pip install openai
pip install networkx
pip install python-dotenv
```

Note: you should use python 3.8 version. 3.9 or 3.10 will not work

## Inference
You can use the notebook ***model_eval_sherpa.ipynb*** to run the algorithm for evaluating a domain model against a reference model.

If you want to evaluate a doamin model against its reference model, update the following code in the notebook ***model_eval_sherpa.ipynb***. This snippet defines the input directory for the reference model and the candidate model.

You need openai api key in .env file in the same directary as the ***model_eval_sherpa.ipynb***. In the .env file, define 
```
openai_key=your_api_key
```


In this example, a domain model generated by **sherpa** method with **gpt-4o-mini** for modeling problem **08_HBMS** is evaluated against its reference solution.

```
##### update here to change input file directory ######
##### update here to change input file directory ######
##### update here to change input file directory ######
##### update here to change input file directory ######

instructor_dir = "results/"

# 01_LabTracker
# 02_CelO
# 03_TSS
# 04_SHAS
# 05_OTS
# 06_Block
# 07_Tile
# 08_HBMS
problem_id = "08_HBMS"

# location of reference domain model is stored. It is in .txt format
instructor_input = instructor_dir + problem_id + ".txt"

# gpt-4o-mini
# gpt-4
# gpt-4o
llm_id = "gpt-4o-mini"

# yujing
# sherpa
method_id = "sherpa"

student_dir = instructor_dir + llm_id + '/' + method_id + '/' + problem_id + '/'
if not os.path.exists(student_dir):
    # Create the directory
    os.makedirs(student_dir)
    
# location of generated domain model is saved. The file should be in .txt    
student_input = student_dir + problem_id + ".txt"
student_input
student_out_dir = student_dir + "result/"
student_out_dir
```
The result will be saved into __student_out_dir__, e.g. __Sherpa4Modeling/sherpa4modeling/Model Evaluation/results/gpt-4o-mini/sherpa/03_TSS/result/algo_result.txt__ in this case


## Model Element format
The domain model format can be found in the [paper](https://www.computer.org/csdl/proceedings-article/models/2023/248000a162/1SOLHZynTpe)

Note: 
- the domain model should **not** contain special characters, e.g., [], <>... They may cause problem in the embedding process...
- Some classes may end up with a inherit notation. You should remove it.
```
Doctor(int practitionerNumber, string signature, date requisitionValidFrom) inherit Person
```
change to 
```
Doctor(int practitionerNumber, string signature, date requisitionValidFrom)
```